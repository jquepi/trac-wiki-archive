[wiki:ContributingToTwistedLabs Contribute] > Twisted Development

= Twisted Development =
[[PageOutline(2-4,, inline)]]

== Contributing ==

Twisted uses the [UltimateQualityDevelopmentSystem The Ultimate Quality Development System], in addition to this ReviewProcess.

If you want to become a developer, it is important to understand that all your contributions (including those initial patches you send to the bug tracker) will have to be licenced under the [http://www.opensource.org/licenses/mit-license.php MIT licence].


=== Getting the source code ===

You can get Twisted's source code here:

{{{
svn co svn://svn.twistedmatrix.com/svn/Twisted/trunk MyTwistedTrunk
}}}

If you prefer not to use {{{svn}}}, you can use a number of other version control systems to produce patches for review.

See [wiki:VcsWorkflows DVCS Workflows] for help using Git, Bazaar, and Mercurial to manage local development.


=== Creating your work environment ===

Twisted development does not enforce any specific work/build environment.

For your convenience, the setup.py file defined optional components, `dev` component being one of them.

Here is an example of creating an environment using virtualenv.
{{{
# Create base environment.
virtualenv build/
. build/bin/activate

# Install dev dependencies, also forcing upgrade of existing versions.
pip install -e -U ".[dev]"

# Use the dev tools.
./bin/trial twisted.conch.test.test_transport
twistedchecker twisted.conch.ssh.transport
pyflakes twisted/conch/ssh/transport.py

}}}


=== Submitting a Patch ===

Here's a quick step-by-step guide to getting from an idea for an improvement to Twisted to something that we can integrate.  First, I'll explain just the mechanics of getting your code into review, not what the code itself should do.  If you actually want us to be able to use your code, you will also want to read the section below on getting your patch accepted, too!

  1. Check out the source code via one of the supported VCSs.
  1. Edit the code in the branch that you just checked out, making your awesome change to Twisted.
  1. Now is a good time to make sure that your patch fulfills all of the requirements of the [http://twistedmatrix.com/trac/wiki/ReviewProcess review process], so you don't need to submit your patch many repeated times. Pay special attention to the section about [http://twistedmatrix.com/trac/wiki/ReviewProcess#Newsfiles news files]!
  1. Generate a patch file. See: [wiki:VcsWorkflows]
  1. If you haven't already, [http://twistedmatrix.com/trac/register register for an account on this website].  If you have, make sure you are logged in.
  1. Search for an existing ticket which describes your change, using both the "search" field above, and Google.
    1. If you can't find one, file a new ticket using the "new ticket" link above. See: [#TicketManagement Ticket management]
  1. Click on the "attach file" button on your ticket, and upload the `.patch` file you generated above.
  1. Put the ticket into review.  This is accomplished by doing the following:
    1. enter the word "review" into the "keywords" field of the ticket.  (If there are other keywords already there, just add a space to separate the keyword.)
    1. Click on the "reassign to" radio button.
    1. Select the topmost, blank entry from the "reassign to" button.
    1. Optionally, add a comment explaining which patch you would like reviewed (if there are already other attached files), and explaining ''what'' your change does (as opposed to the ''why'' you want it done, which you should have put into the ticket's summary and description).
    1. Hit "submit changes".
  1. At this point, you need to wait for feedback.  If your patch is very good, very simple, and obviously correct, we may just apply it, but it is ''very unlikely'' that the first draft of a patch will be accepted as-is.  When a Twisted developer reviews your patch, they will re-assign the ticket to you; you can [http://twistedmatrix.com/trac/report/7 see the list of tickets assigned to you by clicking here].  Unfortunately, the time it takes us to deal with a ticket submitted for review is highly variable, and depends on how many other tickets are waiting review, the amount of free time that the Twisted core development team has, and how many resources we have available for [http://labs.twistedmatrix.com/ sponsored development].
  1. When you do receive a review comment, attach a new patch (again un-assigning the ticket and adding the "review" keyword to it) which addresses that feedback.


=== Getting Your Patch Accepted ===

If you are interested in contributing to Twisted for the first time, consider working on an existing ticket rather than contributing a new feature.  Fixes for existing problems or implementations of already-requested features will generally take priority over new ideas.  Consider discussing the work you want to do with [wiki:TwistedCommunity other Twisted developers first].

Familiarize yourself with project policies and coding standards and make sure your full contribution (code, test, documentation, design) adheres to it. See: [#Policies Policies]

Make sure that you have written unit tests and docstrings for all code which has changed in your patch.  It works best if you use test-driven development to write your patch initially, and write your tests before your code.  (Believe me, if you write your tests after you write your code, we ''will'' know.  It's more obvious than you think.)

Run the full test suite ''before'' submitting your patch, and fix any problems you discover.  If a reviewer notices failing tests, they may not give your code a deep look, and you may have to wait longer for a second review. See: [#ToolsForDevelopment Tools for development]

Some users may discover that their system is unusual and Twisted's test suite ''does not pass'' "out of the box".  If this is the case, just make sure that the ''same'' tests are failing for you in a pristine checkout of trunk and with your changes applied.  Then, in addition to submitting your patch, please let us know about the problem with the test suite!


== Tools For Development ==

There are a few useful tools for developing Twisted. Some of them are included with Twisted, some are third-party dependencies.

Command from this section assume that you run them from withing Twisted source code checkout root.

To run the tests, simply run `./bin/trial twisted`. Make sure you run trial command that comes with twisted source code and not the one provided by your operating system.

To generate the narrative documentation, `cd docs; make html`. Files are generated in `docs/_build/html/`. Make sure you have the latest Python Sphinx version.

Many ancillary tools related to Twisted are in Bazaar repositories.  You may find it useful to [http://bazaar.canonical.com/en/ install the Bazaar version control system for your platform] so that you can easily get access to these.

To generate the API documentation, you will need [https://launchpad.net/pydoctor pydoctor].  It depends on [http://epydoc.sourceforge.net/ epydoc].  Once you've got it, `./bin/admin/build-apidocs . apidocs` and look in the generated `apidocs` directory.

After every commit to Twisted, the buildbot runs all the unit tests and reports [http://buildbot.twistedmatrix.com/ test results on several platforms].  Here is a page showing only the [http://buildbot.twistedmatrix.com/boxes-supported test results on supported platforms]. All tests on supported platforms always pass. Watch the buildbot. Because sometimes, the buildbot watches back.


== Runtime and development depenencies ==

Required and optional dependencies are now documented inside the source code [browser:trunk/twisted/python/dist.py] `_EXTRAS_REQUIRE` variable.

Some optional dependencies are not yet documented and they are presented here:

 * pygtk (or pygi or pygobject or something) is required for the gtk class of reactors
 * wxpython is required for wxsupport / wxreactor
 * gadfly, sqlite, pypgsql, psycopg, mysqldb, kinterbasdb (at least one) are required for twisted.enterprise.adbapi
 * SOAPpy is required for Twisted Web's SOAP support
 * pypam is required for twisted.cred PAM integration


And there are some additional development tools:

 * subunit is required for trial's subunit output plugin
 * cython is required to update iocpreactor and some Failure unit tests


== Tickets management ==

All changes to source code require a ticket.

If you file a new ticket, please start with a clear description of ''why'' such a change is desirable.
We can read your attached code to find out ''what'' you are doing, but we can't read your mind to figure out why you want it done!

A Twisted ticket can be of one of three types.

  * Enhancements are used for feature additions.  These typically take the form of a new API or an expansion of an existing API.  Enhancement tickets should clearly describe the desired feature.  The more well specified a feature is, the more likely it is to be implemented (and importantly, the more likely it is that what is implemented will actually be what the reporter wanted!) and the easier it is to implement.  Remember that the ticket is possibly the only persistent record of the feature request.  If it is not self-contained and sufficiently detailed, then it will likely fail to communicate the reporter's idea, diminishing its value (possibly all the way down to zero).

  * Defects are used to track bugs in existing APIs.  Defect tickets are easier to specify than enhancements.  A defect should briefly describe the problem, but the bulk of the ticket should be a runnable program (ideally in the form of a unit test) which demonstrates the bug.

  * Regressions are similar to defects, but are for bugs which are introduced into APIs in newer releases of Twisted.  Like defect tickets, regression tickets should have a runnable program attached to demonstrate the problem.

A ticket can have attached the following official tags [wiki:BugKeywords]

There are some UsefulQueries for finding issues in the tracker.


== Policies ==

This series of documents is designed for people who wish to contribute to the Twisted codebase.

 * [http://twistedmatrix.com/documents/current/core/development/policy/coding-standard.html Coding Standard]

 * [http://twistedmatrix.com/documents/current/core/development/naming.html Naming Conventions]

 * [http://twistedmatrix.com/documents/current/core/development/policy/test-standard.html Unit Tests in Twisted]

 * [http://epydoc.sourceforge.net/epytext.html Epytext] for docstrings format.

 * [http://sphinx-doc.org/rest.html ReStructuredText and Sphinx] for narrative documentation.

 * [http://twistedmatrix.com/documents/current/core/development/policy/doc-standard.html Documentation Standard]

 * [http://twistedmatrix.com/documents/current/core/development/policy/writing-standard.html Writing Standard]

 * [wiki:Security Security]

 * [CompatibilityPolicy Compatibility Policy]

 * [http://twistedmatrix.com/documents/current/core/development/philosophy.html Philosophy]

 * [http://twistedmatrix.com/documents/current/core/development/policy/svn-dev.html Subversion Development]

 * [wiki:ReviewProcess Review Process]

== Wiki pages maintenance ==

Changes to wiki pages don't require a ticket.

To prevent spam-bots, newly registered accounts don't have write access for wiki pages.

If you want to edit wiki pages, ask for write permission via one of [wiki:TwistedCommunity community communication channel]. Please mention your Trac username.


== Win32 development ==

If you want to hack Twisted or just use Twisted SVN on Win32, see Ying Li's [http://blog.ying.li/2012/03/twisted-development-on-windows-v2.html short tutorial on setting up a Twisted win32 development environment].


== Twisted Maintenance ==

You might be interested in learning about tasks related to [wiki:SiteMaintenance maintaining this website] or for [wiki:ReleaseProcess releasing Twisted].